# 背景

# 设计
## 总览
用例图；数据流向图；架构设计图。

注：
- 下述"系统环境描述"指的是该模块能够在怎样的操作系统、硬件设施、软件框架的总体环境下正常运行；
- 下述"软件依赖描述"指的是该模块所依赖的所有软件的描述，包括编程语言，编程语言版本，第三方库等；
- 在设计部分，以上描述相较于实现部分的同类描述，较为简略许多；
- 下述"设计职能目标描述"指的是该模块的预期功能描述，后续篇章会对该目标进行验收；
- 下述"设计性能目标描述"指的是该模块的预期性能描述，后续篇章会对该目标进行验收；


## 客户端CLI
参数列表，使用案例，流程图。**从略**。

## 应用服务器
系统环境描述，软件依赖描述，设计职能目标描述，设计性能目标描述

应用服务器直接接受客户端的作业请求，并转发给ERA核心，从ERA核心获取响应后再向客户端发出响应，全程对于客户端来说是同步的（非异步），这就要求ERA核心具有非常高的响应速度。

## 云接口
软件依赖描述（尤其是所依赖的底层云服务的具体描述），设计职能目标描述，设计性能目标描述。

云接口的设计参考分布式任务队列celery：
![](http://opkk27k9n.bkt.clouddn.com/18-4-16/1740887.jpg)
几大关键子模块：
0. user
1. broker
2. worker
2. backend



## ERA核心
系统环境描述，软件依赖描述，设计职能目标描述（尤其是在整个系统架构中的地位），设计性能目标描述

# 实现

## 客户端CLI
Python实现，Python2/Python3兼容，可以使用pip/anaconda等包管理工具安装。

## 应用服务器
Python实现，基于flask框架，采用uwsgi+nginx+supervisor部署，使用JSON作为API数据交换格式。

## 云接口
按照设计，以ERA核心中的user子模块作为user，broker采用redis，worker由Python实现，backend采用redis。
其中，worker是处理作业描述信息中所指定的要求，直接与底层云设施进行交互的关键模块。
ERA核心中的user子模块，只需要向broker发送与某作业绑定的资源预定描述信息即可。